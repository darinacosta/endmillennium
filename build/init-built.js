function soundtrackSvc(){var e={};return e.tracks={click1:{name:"click1",volume:.3},click2:{name:"click2",volume:.3},click3:{name:"click3",volume:.3},unclick1:{name:"unclick1",volume:.5},getitem:{name:"getitem",volume:.2},gulfnight:{name:"gulfnight",volume:1,loop:!0,background:!0},intro:{name:"intro",volume:.6,played:0,loop:!1},crackle:{name:"crackle",volume:.2,loop:!0},save:{name:"save",volume:.5,loop:!1}},e}function audioHelperSvc(e){var t={},n=e.tracks;return t.applyAudioVolume=function(){for(var e in n)n.hasOwnProperty(e)&&(n[e].audio=document.getElementById(n[e].name),n[e].audio.volume=n[e].volume)},t.buildHtmlAudioElements=function(){var e=$("#audio-preload"),t="";for(var i in n)if(n.hasOwnProperty(i)){var o=n[i].loop?" loop>":" >";t+='<audio id="'+n[i].name+'"'+o+'<source src="assets/audio/'+n[i].name+'.ogg"></source><source src="assets/audio/'+n[i].name+'.mp3"></source></audio>'}e.html(t)},t.muteBackgroundMusic=function(){},t.muteSoundFx=function(){for(var e in n)n.hasOwnProperty(e)&&(n[e].background||(n[e].audio=document.getElementById(n[e].name),n[e].audio.volume=0))},t.unmuteSoundFx=function(){for(var e in n)n.hasOwnProperty(e)&&(n[e].background||(n[e].audio=document.getElementById(n[e].name),n[e].audio.volume=n[e].volume))},t.muteMusic=function(){for(var e in n)n.hasOwnProperty(e)&&n[e].background&&(n[e].audio=document.getElementById(n[e].name),n[e].audio.volume=0)},t.unmuteMusic=function(){for(var e in n)n.hasOwnProperty(e)&&n[e].background&&(n[e].audio=document.getElementById(n[e].name),n[e].audio.volume=n[e].volume)},t.returnBackgroundTheme=function(){for(var e in n)if(n.hasOwnProperty(e)&&n[e].background)return n[e].name},t.returnClickTracks=function(){var e=[];for(var t in n)n.hasOwnProperty(t)&&"click"==n[t].name.substring(0,5)&&e.push(n[t].name);return e},t}function transitionSvc(e){var t={};return t.chapters={1:{id:1,title:"The Highway",clicked:!1,passage_name:"The highway"},2:{id:2,title:"The Endless Aisles",clicked:!1,passage_name:"Enter Wal-Mart"}},t.activateChapterEvents=function(){$("html").on("click",function(e){t.triggerChapterEvent(e,t.chapters[1]),t.triggerChapterEvent(e,t.chapters[2])})},t.triggerChapterEvent=function(e,t){$(e.target).is('[passage-name="'+t.passage_name+'"]')&&!t.clicked&&(t.clicked=!0,$("tw-passage").fadeOut(0,function(){var e='<div class="text-section chapter" id="chapter'+t.id+'"><div class="inner-chapter"><div class="chapter-header">Chapter '+t.id+'</div><br><div class="chapter-title">'+t.title+"</div></div></div>";$("body").append(e),$("#chapter"+t.id).css("visibility","visible").hide().fadeIn("slow").delay(3e3).fadeOut("slow",function(){$("tw-passage").fadeIn(1e3)})}))},t}function audioEventSvc(e,t,n){var i={},o=t.tracks,c=n.chapters;return i.applyAudioHtmlTriggers=function(){$(document).ready(function(){var t=e.returnBackgroundTheme();o[t].audio.play(),$("html").on("click",function(t){$(t.target).hasClass("replay")&&location.reload();for(chapter in c)if($(t.target).is('[passage-name="'+c[chapter].passage_name+'"]')&&!c[chapter].clicked)return void o.intro.audio.play();if($(t.target).is("tw-link:not(.visited)")){var n=e.returnClickTracks(),i=Math.floor(Math.random()*n.length),a=n[i];o[a].audio.play()}$(t.target).is(".visited")&&o.unclick1.audio.play(),$(t.target).is(".undo")&&o.unclick1.audio.play(),$(t.target).is(".save:not(.clicked)")&&($(t.target).addClass("clicked"),o.save.audio.play()),$(t.target).is(".load")&&endmillennium.saveData&&(o.intro.played+=1,o.intro.audio.play())})})},i}function audioCtrl(e,t){var n={};return n.init=function(){e.buildHtmlAudioElements(),e.applyAudioVolume(),t.applyAudioHtmlTriggers()},n}function textSectionBackgroundSvc(){var e={};return e.backgrounds={angeladriving:{img:"angeladriving"},celltower:{img:"celltower"},electricsky:{img:"electricsky"},headlights:{img:"headlights"},"headlights-off":{img:"headlights-off"},"met-shep":{img:"cellphone"},shepheadlamp:{img:"shepheadlamp"},"shep-on-haunches":{img:"shepsmoking"},"shep-sitting":{img:"shep"},"static":{img:"refinery"},takeknife:{img:"takeknife"},twistedtrees:{img:"twistedbranches"},"walmart-question":{img:"shepeyes"}},e}function textSectionHelperSvc(e){var t={},n=e.backgrounds;return t.applyBackgroundImages=function(e){var t=["static","static2","static3"],i="";e["static"]||(i+=".text-section{background-image: url(assets/images/dark.png)}");for(var o in n)if(n.hasOwnProperty(o)&&n[o].img){var c=".text-section."+o;if(i+=c+"{background-image: url(assets/images/"+n[o].img+".png)",e["static"]){var a=Math.floor(Math.random()*t.length);i+=", url(assets/images/"+t[a]+".gif)} "}else i+="} "}return i},t.applyBackgroundImagesWithStatic=function(){var e=t.applyBackgroundImages({"static":!0});$("<style id='text-section-background'>").text(e).appendTo("head")},t.removeStatic=function(){var e=t.applyBackgroundImages({"static":!1});$("#text-section-background").text(e)},t.addStatic=function(){var e=t.applyBackgroundImages({"static":!0});$("#text-section-background").text(e)},t}function textSectionCtrl(e,t){var n={};e.backgrounds;return n.init=function(){t.applyBackgroundImagesWithStatic()},n}function transitionCtrl(e){var t={};return t.init=function(){e.activateChapterEvents()},t}function menuHelperSvc(e,t){function n(e){e.fullscreenElement||e.msFullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||(e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen())}var i={};return i.prependMenu=function(){$("html").prepend('<div class="gameplay-menu"><form action=""><input type="checkbox" id="fullscreen"> fullscreen <input type="checkbox" id="staticSelect" checked> static <input type="checkbox" id="musicSelect" checked> music <input type="checkbox" id="soundfxSelect" checked> soundfx</form></div>'),$(".gameplay-menu").on("click",function(){if(document.getElementById("fullscreen").checked){if(!document.fullscreenElement){var i=document.getElementById("game");n(i)}}else document.exitFullscreen&&document.exitFullscreen();document.getElementById("staticSelect").checked?e.addStatic():e.removeStatic(),document.getElementById("soundfxSelect").checked?t.unmuteSoundFx():t.muteSoundFx(),document.getElementById("musicSelect").checked?t.unmuteMusic():t.muteMusic()})},i}function menuCtrl(e){var t={};return t.init=function(){e.prependMenu()},t}function init(e,t,n,i){$("body, tw-story").wrapAll("<div id='game'></div>"),$("body").append('<div id="loadscreen">_loading</div>'),e.init(),t.init(),n.init(),i.init(),$("#loadscreen").css("visibility","hidden")}define("components/audio/soundtrackSvc",[],soundtrackSvc),define("components/audio/audioHelperSvc",["components/audio/soundtrackSvc"],audioHelperSvc),define("components/transitions/transitionSvc",["components/audio/soundtrackSvc"],transitionSvc),define("components/audio/audioEventSvc",["components/audio/audioHelperSvc","components/audio/soundtrackSvc","components/transitions/transitionSvc"],audioEventSvc),define("components/audio/audioCtrl",["components/audio/audioHelperSvc","components/audio/audioEventSvc"],audioCtrl),define("components/text-section/textSectionBackgroundSvc",[],textSectionBackgroundSvc),define("components/text-section/textSectionHelperSvc",["components/text-section/textSectionBackgroundSvc"],textSectionHelperSvc),define("components/text-section/textSectionCtrl",["components/text-section/textSectionBackgroundSvc","components/text-section/textSectionHelperSvc"],textSectionCtrl),define("components/transitions/transitionCtrl",["components/transitions/transitionSvc"],transitionCtrl),define("components/menu/menuHelperSvc",["components/text-section/textSectionHelperSvc","components/audio/audioHelperSvc"],menuHelperSvc),define("components/menu/menuCtrl",["components/menu/menuHelperSvc"],menuCtrl),require(["components/audio/audioCtrl","components/text-section/textSectionCtrl","components/transitions/transitionCtrl","components/menu/menuCtrl"],init),define("init",function(){});